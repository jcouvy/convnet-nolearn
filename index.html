<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Testing project site by jcouvy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Testing project site</h1>
      <h2 class="project-tagline">This is literally a fish &gt;)))]°&gt;</h2>
      <a href="https://github.com/jcouvy/convnet-nolearn" class="btn">View on GitHub</a>
      <a href="https://github.com/jcouvy/convnet-nolearn/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/jcouvy/convnet-nolearn/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p>Greetings, blablabla i'm a french student trying to speak decent english and write a blog about ML.</p>

<h2>
<a id="prerequisites" class="anchor" href="#prerequisites" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prerequisites</h2>

<p>This automatic page generator is the easiest way to create beautiful pages for all of your projects. Author your page content here <a href="https://guides.github.com/features/mastering-markdown/">using GitHub Flavored Markdown</a>, select a template crafted by a designer, and publish. After your page is generated, you can check out the new <code>gh-pages</code> branch locally. If you’re using GitHub Desktop, simply sync your repository and you’ll see the new branch.</p>

<h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h2>

<p>We’ve crafted some handsome templates for you to use. Go ahead and click 'Continue to layouts' to browse through them. You can easily go back to edit your page before publishing. After publishing your page, you can revisit the page generator and switch to another theme. Your Page content will be preserved.</p>

<h3>
<a id="convolutional-network" class="anchor" href="#convolutional-network" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Convolutional network</h3>

<h2>
<a id="lets-make-a-first-model" class="anchor" href="#lets-make-a-first-model" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Let's make a first model</h2>

<p>We will start to fiddle with the different layers available. This is where <code>nolearn</code> really shines as it allows a clear and easy way to implement your net. First we need to import a few modules:</p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> lasagne
<span class="pl-k">from</span> lasagne <span class="pl-k">import</span> layers <span class="pl-c">#this allows us to use each pre-defined layer.</span>
<span class="pl-k">from</span> nolearn.lasagne <span class="pl-k">import</span> NeuralNet <span class="pl-c">#used to implement your net in a very simple fashion.</span></pre></div>

<p>We need to initialize our network just like a variable, let's name it <code>net0</code>. The initialization is divided in two steps:</p>

<ul>
<li>Describe the network architecture (i.e: layer composition)</li>
<li>Initialize each layer's parameters</li>
</ul>

<div class="highlight highlight-source-python"><pre>net0 <span class="pl-k">=</span> NeuralNet(
    <span class="pl-v">layers</span> <span class="pl-k">=</span> [(<span class="pl-s"><span class="pl-pds">'</span>layer1_name<span class="pl-pds">'</span></span>, layers.InsertLayerType),
              (<span class="pl-s"><span class="pl-pds">'</span>layer2_name<span class="pl-pds">'</span></span>, layers.InsertLayerType),
              (<span class="pl-c1">...</span>)],
    <span class="pl-v">layer1_param1</span> <span class="pl-k">=</span> <span class="pl-c1">...</span>, <span class="pl-v">layer1_param2</span> <span class="pl-k">=</span> <span class="pl-c1">...</span>,
    <span class="pl-v">layer2_param1</span> <span class="pl-k">=</span> <span class="pl-c1">...</span>, <span class="pl-v">layer2_param2</span> <span class="pl-k">=</span> <span class="pl-c1">...</span>,
)</pre></div>

<p><strong>Bear in mind that you need to use the pre-defined parameters name or an error will occur</strong></p>

<p>You are probably not yet familiar with each different layers, no worries we are going to cover that right now. Every single available layer is already implemented in Lasagne and that's good news. Despite being young its documentation is rich and the community is helpful, the following link will get you to the <a href="https://lasagne.readthedocs.io/en/latest/modules/layers.html">Lasagne official documentation</a> where each layer is described.</p>

<p>Now that we have the doc opened we can start playing with <code>net0</code> :</p>

<div class="highlight highlight-source-python"><pre>net0 <span class="pl-k">=</span> NeuralNet(
    <span class="pl-v">layers</span> <span class="pl-k">=</span> [(<span class="pl-s"><span class="pl-pds">'</span>input<span class="pl-pds">'</span></span>, layers.InputLayer),
              (<span class="pl-s"><span class="pl-pds">'</span>conv<span class="pl-pds">'</span></span>, layers.Conv2DLayer),
              (<span class="pl-s"><span class="pl-pds">'</span>maxpool<span class="pl-pds">'</span></span>, layers.MaxPool2DLayer),
              (<span class="pl-s"><span class="pl-pds">'</span>output<span class="pl-pds">'</span></span>, layers.DenseLayer)
              ],
   <span class="pl-v">input_shape</span> <span class="pl-k">=</span> (<span class="pl-c1">None</span>, <span class="pl-c1">1</span>, <span class="pl-c1">28</span>, <span class="pl-c1">28</span>), 

   <span class="pl-v">conv_num_filters</span> <span class="pl-k">=</span>  <span class="pl-c1">8</span>, <span class="pl-v">conv_filter_size</span> <span class="pl-k">=</span> (<span class="pl-c1">3</span>, <span class="pl-c1">3</span>),
   <span class="pl-v">maxpool_pool_size</span> <span class="pl-k">=</span> (<span class="pl-c1">2</span>, <span class="pl-c1">2</span>),

   <span class="pl-v">output_num_units</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>, <span class="pl-v">output_nonlinearity</span> <span class="pl-k">=</span> lasagne.nonlinearities.softmax,

   <span class="pl-v">max_epochs</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>,
   <span class="pl-v">verbose</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>,
)</pre></div>

<p>So what do we have here...</p>

<ul>
<li>
<code>input_shape</code> describes the data processed by the network. Later on we will use a handwritten digit database named MNIST (you can find more about it <a href="http://yann.lecun.com/exdb/mnist/">here</a>). Each digit is a 28x28 1-dimensionnal image (grayscale so only 1 color channel).<br>
NB: the first parameter indicates the size of the batch, <code>None</code> means it is not fixed at compile time, thus <code>nolearn</code> will figure the value on its own.</li>
<li>
<code>conv_num_filters</code> is the amount of filters (or kernels) you will use and <code>conv_filter_size</code> specifies their size, same goes for <code>maxpool_pool_size</code>.</li>
<li>
<code>output_num_units</code> means that you sub-sample your data down to 10 images.</li>
<li>
<code>output_nonlinearity</code> is the activation function used, here it's the maximum (most commonly used for classification problems).</li>
</ul>

<p>Picking the proper sizes seems a little mystical but we will get to that. A nice visualization of the filtering process can be found in a JavaScript implementation <a href="http://cs.stanford.edu/people/karpathy/convnetjs/demo/mnist.html">here</a> (credits to <a href="https://github.com/Karpathy" class="user-mention">@Karpathy</a>).</p>

<p>Now that we have a functional implementation we have to train it !</p>

<h2>
<a id="loading-a-data-set" class="anchor" href="#loading-a-data-set" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Loading a data-set</h2>

<p>We are going to use the set used in the <a href="https://www.kaggle.com/c/digit-recognizer">Kaggle MNIST competition</a>. </p>

<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> pandas <span class="pl-k">as</span> pd
<span class="pl-k">import</span> numpy <span class="pl-k">as</span> np
<span class="pl-k">from</span> urllib <span class="pl-k">import</span> urlretrieve 

filename1, url1 <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>input/test.csv<span class="pl-pds">'</span></span>,  <span class="pl-s"><span class="pl-pds">'</span>https://www.kaggle.com/c/digit-recognizer/download/test.csv<span class="pl-pds">'</span></span>
filename2, url2 <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>input/train.csv<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>https://www.kaggle.com/c/digit-recognizer/download/train.csv<span class="pl-pds">'</span></span>

<span class="pl-k">if</span> <span class="pl-k">not</span> os.path.exists(filename):
    <span class="pl-c1">print</span>(<span class="pl-s"><span class="pl-pds">"</span>Downloading MNIST dataset...<span class="pl-pds">"</span></span>)
    urlretrieve(url1, filename1)
    urlretrieve(url2, filename2)

<span class="pl-c"># The competition datafiles are in the directory ../input</span>
<span class="pl-c"># Read competition data files:</span>
train <span class="pl-k">=</span> pd.read_csv(<span class="pl-s"><span class="pl-pds">"</span>../input/train.csv<span class="pl-pds">"</span></span>).values
test  <span class="pl-k">=</span> pd.read_csv(<span class="pl-s"><span class="pl-pds">"</span>../input/test.csv<span class="pl-pds">"</span></span>).values

train_labels <span class="pl-k">=</span> train.ix[:,<span class="pl-c1">0</span>].values.astype(np.int32)
train_images <span class="pl-k">=</span> train.ix[:,<span class="pl-c1">1</span>:].values.astype(np.float32)
train_images <span class="pl-k">/=</span> train_images.std(<span class="pl-v">axis</span><span class="pl-k">=</span><span class="pl-c1">None</span>)
train_images <span class="pl-k">-=</span> train_images.mean()</pre></div>

<div class="highlight highlight-source-python"><pre>trainX <span class="pl-k">=</span> train_images.reshape(<span class="pl-k">-</span><span class="pl-c1">1</span>,<span class="pl-c1">1</span>,<span class="pl-c1">28</span>,<span class="pl-c1">28</span>)
trainY <span class="pl-k">=</span> train_labels
net0.fit(trainX, trainY)</pre></div>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>You can <a href="https://help.github.com/articles/basic-writing-and-formatting-syntax/#mentioning-users-and-teams" class="user-mention">@mention</a> a GitHub username to generate a link to their profile. The resulting <code>&lt;a&gt;</code> element will link to the contributor’s GitHub Profile. For example: In 2007, Chris Wanstrath (<a href="https://github.com/defunkt" class="user-mention">@defunkt</a>), PJ Hyett (<a href="https://github.com/pjhyett" class="user-mention">@pjhyett</a>), and Tom Preston-Werner (<a href="https://github.com/mojombo" class="user-mention">@mojombo</a>) founded GitHub.</p>

<h3>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>Having trouble with Pages? Check out our <a href="https://help.github.com/pages">documentation</a> or <a href="https://github.com/contact">contact support</a> and we’ll help you sort it out.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/jcouvy/convnet-nolearn">Testing project site</a> is maintained by <a href="https://github.com/jcouvy">jcouvy</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
